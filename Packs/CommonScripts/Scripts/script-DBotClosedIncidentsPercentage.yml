comment: 'Data output script for populating dashboard pie graph widget with the percentage
  of incidents closed by DBot vs. incidents closed by analysts

  This automation runs using the default Limited User role, unless you explicitly
  change the permissions.

  For more information, see the section about permissions here: https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html'
commonfields:
  id: DBotClosedIncidentsPercentage
  version: -1
enabled: true
fromversion: 5.0.0
name: DBotClosedIncidentsPercentage
runas: DBotRole
runonce: false
script: "var res = executeCommand(\"getIncidents\", {\n    'query': 'status:closed\
  \ and investigation.users:\"\"',\n    'fromdate': args.from,\n    'todate': args.to,\n\
  \    'size': 0\n});\nvar closedByDbot = res[0].Contents.total;\n\nres = executeCommand(\"\
  getIncidents\", {\n    'status': 'closed',\n    'fromdate': args.from,\n    'todate':\
  \ args.to,\n    'size': 0\n});\nvar overallClosed = res[0].Contents.total;\n\nvar\
  \ result = Math.round(closedByDbot * 100 / overallClosed);\nreturn isNaN(result)\
  \ ? 0 : result;"
scripttarget: 0
tags:
- widget
tests:
- No tests (auto formatted)
type: javascript
