args:
- defaultValue: '1000'
  description: Maximum number of incidents (to fetch from the database) to consider
    for machine-learning calculation.
  name: maxNumberOfIncidents
- defaultValue: '72'
  description: Check candidates for duplication in this time frame of number of days
    from\after.
  name: timeFrameHours
- auto: PREDEFINED
  defaultValue: 'yes'
  description: Ignore closed incidents as potential candidates.
  name: ignoreClosedIncidents
  predefined:
  - 'yes'
  - 'no'
- defaultValue: '0.5'
  description: Threshold to consider incident as duplication, number between 0-1
  name: threshold
- defaultValue: Email, IP, Domain, File SHA256, File MD5, URL
  description: 'Indicators to consider for duplicate calculation, from the following
    options: Email, IP, Domain, File SHA256, File MD5, URL. Comma separated values'
  name: compareIndicators
- defaultValue: Email/headers/From, Email/headers/Subject, Email/text, Email/html,
    Email/attachments
  description: 'Email labels to consider for duplicate calculation, from the following
    options: Email/headers/From, Email/headers/Subject, Email/text, Email/html, Email/attachments.
    Comma separated values. If your labels are different from the default, please
    specify your labels as follows: LABEL_NAME:YOUR_LABEL_NAME. For example, email/from:email_sender.'
  name: compareEmailLabels
- auto: PREDEFINED
  defaultValue: 'yes'
  description: If yes - take into account all labels keys.
  name: compareOtherLabels
  predefined:
  - 'yes'
  - 'no'
- auto: PREDEFINED
  defaultValue: 'yes'
  description: If yes - take into account incident time differences.
  name: compareIncidentTimeDiff
  predefined:
  - 'yes'
  - 'no'
- defaultValue: '0'
  description: Consider duplicate incident examples from the local environment within
    the last "X" days. Default is 0, which means do not use.
  name: UseLocalEnvDuplicatesInLastDays
- defaultValue: '32'
  description: Consider the equity of the IP base on this subnet mask (a valid value
    is a number between 0 - 32). Default is 32 which means an exact match of the IP
    addresses.
  name: ipComparisonSubnetMask
- defaultValue: '10'
  description: Maximum number of candidates in the output (in incidents candidate
    list).
  name: maxResults
- auto: PREDEFINED
  defaultValue: created
  description: Time field to consider.
  name: timeField
  predefined:
  - occurred
  - created
  - modified
comment: 'Deprecated. Use the "PhishingDedupPreprocessingRule" script instead.

  Find duplicate incidents candidates.

  Using machine learning techniques with pre-defined data (can also use data from
  the local environment), this script takes into consideration different features
  such as: labels comparison, email labels (relevant for phishing), incident time
  difference and shared indicators, which can be customized by the arguments.

  This automation runs using the default Limited User role, unless you explicitly
  change the permissions.

  For more information, see the section about permissions here: https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html'
commonfields:
  id: GetDuplicatesMlv2
  version: -1
deprecated: true
dockerimage: demisto/machine-learning:1.0.0.22015
enabled: true
fromversion: 5.0.0
name: GetDuplicatesMlv2
outputs:
- contextPath: similarIncident
  description: Similar incident.
  type: unknown
- contextPath: isSimilarIncidentFound
  description: Found any duplicate?
  type: boolean
- contextPath: similarIncidentList
  description: Similar incident candidates list.
- contextPath: similarIncident.rawId
  description: Similar incident ID.
  type: string
- contextPath: similarIncident.name
  description: Similar incident name.
  type: string
runonce: true
script: ''
scripttarget: 0
subtype: python2
tags:
- dedup
- incidents
- ml
- duplicate
tests:
- No test
type: python
